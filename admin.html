<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>Admin Dashboard - PDF Tools</title>

    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%234F46E5' rx='20' width='100' height='100'/><text x='50%' y='55%' dominant-baseline='middle' text-anchor='middle' font-size='50' fill='white' font-weight='bold'>P</text></svg>">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/ux.css">
    <link rel="stylesheet" href="css/admin.css">
</head>

<body>
    <!-- Login Screen -->
    <div class="admin-login" id="loginScreen">
        <div class="login-card">
            <div class="login-header">
                <div class="logo">
                    <span class="logo-icon">P</span>
                    <span>PDF<span class="text-gradient">Tools</span></span>
                </div>
                <h1>Admin Dashboard</h1>
                <p>Enter your password to access analytics</p>
            </div>

            <form id="loginForm" onsubmit="return handleLogin(event)">
                <!-- Honeypot field -->
                <input type="text" name="website_url_confirm" id="website_url_confirm"
                    style="position:absolute;left:-9999px;opacity:0;" tabindex="-1" autocomplete="off">

                <div class="form-group">
                    <label for="adminPassword">Password</label>
                    <input type="password" id="adminPassword" class="input" placeholder="Enter admin password" required
                        autofocus>
                </div>

                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    üîì Access Dashboard
                </button>

                <p class="login-hint">Default: admin123 (change this!)</p>
            </form>

            <div id="loginError" class="error-message hidden"></div>
        </div>
    </div>

    <!-- Dashboard (hidden until login) -->
    <div class="admin-dashboard hidden" id="dashboard">
        <!-- Admin Header -->
        <header class="admin-header">
            <div class="admin-header-left">
                <a href="index.html" class="logo">
                    <span class="logo-icon">P</span>
                    <span>PDF<span class="text-gradient">Tools</span></span>
                </a>
                <span class="admin-badge">Admin</span>
            </div>

            <div class="admin-header-right">
                <span class="admin-time" id="currentTime"></span>
                <button class="btn btn-ghost" onclick="refreshDashboard()">üîÑ Refresh</button>
                <button class="btn btn-ghost" onclick="exportAllData()">üì• Export</button>
                <button class="btn btn-ghost text-error" onclick="logout()">üö™ Logout</button>
            </div>
        </header>

        <!-- Dashboard Content -->
        <main class="admin-main">
            <!-- Stats Overview -->
            <section class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon" style="background: rgba(59, 130, 246, 0.1); color: #3b82f6;">üìä</div>
                    <div class="stat-content">
                        <div class="stat-value" id="todayPageViews">0</div>
                        <div class="stat-label">Today's Page Views</div>
                    </div>
                    <div class="stat-trend up" id="pageViewsTrend">+0%</div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: rgba(16, 185, 129, 0.1); color: #10b981;">‚ö°</div>
                    <div class="stat-content">
                        <div class="stat-value" id="todayToolUses">0</div>
                        <div class="stat-label">Tools Used Today</div>
                    </div>
                    <div class="stat-trend up" id="toolUsesTrend">+0%</div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: rgba(139, 92, 246, 0.1); color: #8b5cf6;">üë•</div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalVisitors">0</div>
                        <div class="stat-label">Total Unique Visitors</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: rgba(249, 115, 22, 0.1); color: #f97316;">üìÅ</div>
                    <div class="stat-content">
                        <div class="stat-value" id="filesProcessed">0</div>
                        <div class="stat-label">Files Processed (7 days)</div>
                    </div>
                </div>
            </section>

            <!-- Charts Row -->
            <section class="charts-row">
                <!-- Traffic Chart -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3>üìà Traffic Overview (Last 7 Days)</h3>
                        <select id="chartType" class="input" onchange="updateChart()">
                            <option value="pageViews">Page Views</option>
                            <option value="toolUses">Tool Uses</option>
                        </select>
                    </div>
                    <div class="chart-container">
                        <canvas id="trafficChart"></canvas>
                    </div>
                </div>

                <!-- Top Tools -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3>üèÜ Top Tools</h3>
                    </div>
                    <div class="top-tools-list" id="topToolsList">
                        <!-- Rendered by JS -->
                    </div>
                </div>
            </section>

            <!-- Security & Activity Row -->
            <section class="charts-row">
                <!-- Security Status -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3>üîí Security Status</h3>
                        <span class="security-badge" id="securityStatus">‚úÖ Secure</span>
                    </div>
                    <div class="security-stats">
                        <div class="security-item">
                            <span class="security-label">Rate Limiter</span>
                            <span class="security-value" id="rateLimitStatus">Active</span>
                        </div>
                        <div class="security-item">
                            <span class="security-label">Requests (this minute)</span>
                            <span class="security-value" id="requestsCount">0</span>
                        </div>
                        <div class="security-item">
                            <span class="security-label">Bot Detection Score</span>
                            <span class="security-value" id="botScore">0</span>
                        </div>
                        <div class="security-item">
                            <span class="security-label">Security Events</span>
                            <span class="security-value" id="securityEvents">0</span>
                        </div>
                    </div>
                    <div class="security-log" id="securityLog">
                        <!-- Security events rendered here -->
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3>üìã Page Views by Page</h3>
                    </div>
                    <div class="activity-list" id="pageViewsList">
                        <!-- Rendered by JS -->
                    </div>
                </div>
            </section>

            <!-- Data Management -->
            <section class="data-management">
                <h3>üóÑÔ∏è Data Management</h3>
                <div class="data-actions">
                    <div class="data-card">
                        <h4>Export Data</h4>
                        <p>Download all analytics data as JSON</p>
                        <button class="btn btn-secondary" onclick="exportAllData()">üì• Export JSON</button>
                    </div>

                    <div class="data-card">
                        <h4>Import Data</h4>
                        <p>Restore from backup file</p>
                        <input type="file" id="importFile" accept=".json" hidden onchange="importData(event)">
                        <button class="btn btn-secondary" onclick="document.getElementById('importFile').click()">
                            üì§ Import JSON
                        </button>
                    </div>

                    <div class="data-card danger">
                        <h4>Clear All Data</h4>
                        <p>Permanently delete all analytics</p>
                        <button class="btn btn-danger" onclick="confirmClearData()">üóëÔ∏è Clear All</button>
                    </div>

                    <div class="data-card">
                        <h4>Change Password</h4>
                        <p>Update admin password</p>
                        <button class="btn btn-secondary" onclick="showChangePassword()">üîë Change</button>
                    </div>
                </div>
            </section>

            <!-- Daily Stats Table -->
            <section class="daily-stats-section">
                <h3>üìÖ Daily Statistics</h3>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Page Views</th>
                                <th>Tool Uses</th>
                                <th>Files Processed</th>
                                <th>Unique Visitors</th>
                                <th>Errors</th>
                            </tr>
                        </thead>
                        <tbody id="dailyStatsTable">
                            <!-- Rendered by JS -->
                        </tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>

    <!-- Change Password Modal -->
    <div class="modal-backdrop hidden" id="passwordModal">
        <div class="modal">
            <div class="modal-header">
                <h3>üîë Change Password</h3>
                <button class="modal-close" onclick="closeModal('passwordModal')">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Current Password</label>
                    <input type="password" id="currentPassword" class="input" placeholder="Current password">
                </div>
                <div class="form-group">
                    <label>New Password</label>
                    <input type="password" id="newPassword" class="input" placeholder="New password">
                </div>
                <div class="form-group">
                    <label>Confirm New Password</label>
                    <input type="password" id="confirmPassword" class="input" placeholder="Confirm password">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-ghost" onclick="closeModal('passwordModal')">Cancel</button>
                <button class="btn btn-primary" onclick="changePassword()">Update Password</button>
            </div>
        </div>
    </div>

    <!-- Clear Data Confirmation Modal -->
    <div class="modal-backdrop hidden" id="clearModal">
        <div class="modal">
            <div class="modal-header">
                <h3>‚ö†Ô∏è Clear All Data</h3>
                <button class="modal-close" onclick="closeModal('clearModal')">‚úï</button>
            </div>
            <div class="modal-body">
                <p>This will permanently delete all analytics data. This action cannot be undone.</p>
                <p class="text-error">Type <strong>DELETE</strong> to confirm:</p>
                <input type="text" id="deleteConfirm" class="input" placeholder="Type DELETE">
            </div>
            <div class="modal-footer">
                <button class="btn btn-ghost" onclick="closeModal('clearModal')">Cancel</button>
                <button class="btn btn-danger" onclick="clearAllData()">Delete Everything</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="js/app.js"></script>
    <script src="js/analytics.js"></script>
    <script src="js/security.js"></script>
    <script src="js/admin.js"></script>
</body>

</html>